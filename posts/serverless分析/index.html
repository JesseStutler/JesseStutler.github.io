<!doctype html><html><head><title>Serverless分析</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content="serverless现状分析（持续更新）"><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><meta property="og:title" content="Serverless分析"><meta property="og:description" content="serverless现状分析（持续更新）"><meta property="og:type" content="article"><meta property="og:url" content="https://jessestutler.github.io/posts/serverless%E5%88%86%E6%9E%90/"><meta property="og:image" content="https://jessestutler.github.io/images/serverless.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-18T14:13:36+08:00"><meta property="article:modified_time" content="2021-05-18T14:13:36+08:00"><meta property="og:site_name" content="My Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://jessestutler.github.io/images/serverless.jpg"><meta name=twitter:title content="Serverless分析"><meta name=twitter:description content="serverless现状分析（持续更新）"><script src=/vendor/js/jquery.min.js></script><script src=/vendor/js/popper.min.js></script><script src=/vendor/js/bootstrap.min.js></script><script src=/vendor/js/smooth-scroll.polyfills.min.js></script><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><script src=/vendor/js/vue.min.js></script><link rel=stylesheet href=https://jessestutler.github.io/scss/journal.min.c116bc90d171283f099f173854157ec8f183f9073b93443b2c8ad82899ee9025.css integrity="sha256-wRa8kNFxKD8Jnxc4VBV+yPGD+Qc7k0Q7LIrYKJnukCU=" media=screen><link rel=stylesheet href=https://jessestutler.github.io/scss/dark-mode.min.552aae4638a84aa57cf0b195750a49ea9131d3bb621d1ed3ebc9b14b18166536.css integrity="sha256-VSquRjioSqV88LGVdQpJ6pEx07tiHR7T68mxSxgWZTY=" media=screen><script src=https://jessestutler.github.io//js/loadCSS.js></script><script>loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Noto+Serif+SC|Material+Icons")</script><script src=https://jessestutler.github.io//js/toc-collapse.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><script src=/vendor/js/md5.min.js></script><script>var gitalk=new Gitalk({clientID:'your client id',clientSecret:'your client secret',repo:'repo name',owner:'user',admin:['user'],id:md5(location.pathname),distractionFreeMode:'false'});window.onload=function(){gitalk.render('gitalk-container')}</script></head><body><div id=app><div ref=sideContainer class=side-container><a class="a-block nav-head false" href=https://jessestutler.github.io/><div class=nav-title>Jesse's Blog</div><div class=nav-subtitle>Stay Hungry,Stay Foolish.</div></a><div class=nav-link-list><a class="a-block nav-link-item active" href=/posts>归档</a>
<a class="a-block nav-link-item false" href=/categories>分类</a>
<a class="a-block nav-link-item false" href=/tags>标签</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://amazingrise.net>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
本站遵循 CC-BY-NC 4.0 协议</div></div><div ref=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- CATALOG -</center><ul><li><a href=#serverless%e5%88%86%e6%9e%90 onclick="onNavClick(`#serverless分析-nav`)" id=serverless分析-nav>Serverless分析</a></li><ul class=collapse data-toggle=collapse><ul class=collapse data-toggle=collapse><li><a href=#%e7%89%b9%e7%82%b9 onclick="onNavClick(`#特点-nav`)" id=特点-nav>特点</a></li></ul><li><a href=#%e7%8e%b0%e4%bb%8aserverless%e7%9a%84%e6%9c%89%e9%99%90%e6%80%a7 onclick="onNavClick(`#现今serverless的有限性-nav`)" id=现今serverless的有限性-nav>现今Serverless的有限性</a></li><ul class=collapse data-toggle=collapse><li><a href=#%e5%ad%98%e5%82%a8%e5%af%b9%e4%ba%8e%e7%bb%86%e7%b2%92%e5%ba%a6%e6%93%8d%e4%bd%9c%e7%9a%84%e5%b1%80%e9%99%90%e6%80%a7 onclick="onNavClick(`#存储对于细粒度操作的局限性-nav`)" id=存储对于细粒度操作的局限性-nav>存储对于细粒度操作的局限性</a></li><li><a href=#%e7%bc%ba%e5%b0%91%e7%bb%86%e7%b2%92%e5%ba%a6%e7%9a%84%e6%b6%88%e6%81%af%e6%b2%9f%e9%80%9a onclick="onNavClick(`#缺少细粒度的消息沟通-nav`)" id=缺少细粒度的消息沟通-nav>缺少细粒度的消息沟通</a></li><li><a href=#%e6%a0%87%e5%87%86%e6%b2%9f%e9%80%9a%e6%a8%a1%e5%bc%8f%e5%af%b9%e4%ba%8e%e7%bb%86%e7%b2%92%e5%ba%a6%e7%9a%84%e6%80%a7%e8%83%bd%e5%a4%aa%e5%b7%ae onclick="onNavClick(`#标准沟通模式对于细粒度的性能太差-nav`)" id=标准沟通模式对于细粒度的性能太差-nav>标准沟通模式对于细粒度的性能太差</a></li><li><a href=#%e5%86%b7%e5%90%af%e5%8a%a8%e7%9a%84%e5%b1%80%e9%99%90%e6%80%a7 onclick="onNavClick(`#冷启动的局限性-nav`)" id=冷启动的局限性-nav>冷启动的局限性</a></li><ul class=collapse data-toggle=collapse><li><a href=#%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e5%86%b7%e5%90%af%e5%8a%a8%e4%bc%9a%e5%8f%91%e7%94%9f onclick="onNavClick(`#什么时候冷启动会发生-nav`)" id=什么时候冷启动会发生-nav>什么时候冷启动会发生？</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e9%9c%80%e8%a6%81%e8%80%83%e8%99%91%e5%86%b7%e5%90%af%e5%8a%a8%e7%9a%84%e5%bd%b1%e5%93%8d onclick="onNavClick(`#什么时候需要考虑冷启动的影响-nav`)" id=什么时候需要考虑冷启动的影响-nav>什么时候需要考虑冷启动的影响？</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e5%86%b7%e5%90%af%e5%8a%a8%e6%96%b9%e6%a1%88 onclick="onNavClick(`#解决冷启动方案-nav`)" id=解决冷启动方案-nav>解决冷启动方案</a></li><li><a href=#%e9%99%8d%e4%bd%8e%e5%86%b7%e5%90%af%e5%8a%a8%e6%97%b6%e9%97%b4%e7%9a%84%e5%a5%bd%e5%a4%84 onclick="onNavClick(`#降低冷启动时间的好处-nav`)" id=降低冷启动时间的好处-nav>降低冷启动时间的好处</a></li></ul></ul><li><a href=#serverless%e5%8f%af%e4%bb%a5%e6%8e%a2%e7%b4%a2%e7%9a%84%e7%82%b9 onclick="onNavClick(`#serverless可以探索的点-nav`)" id=serverless可以探索的点-nav>Serverless可以探索的点</a></li><ul class=collapse data-toggle=collapse><li><a href=#abstraction onclick="onNavClick(`#abstraction-nav`)" id=abstraction-nav>Abstraction</a></li><li><a href=#system onclick="onNavClick(`#system-nav`)" id=system-nav>System</a></li><li><a href=#network onclick="onNavClick(`#network-nav`)" id=network-nav>Network</a></li><li><a href=#security onclick="onNavClick(`#security-nav`)" id=security-nav>Security</a></li><li><a href=#architecture onclick="onNavClick(`#architecture-nav`)" id=architecture-nav>Architecture</a></li></ul><li><a href=#serverless%e5%b7%b2%e7%bb%8f%e9%80%82%e9%85%8d%e7%9a%84%e5%ba%94%e7%94%a8%e6%8c%81%e7%bb%ad%e6%9b%b4%e6%96%b0 onclick="onNavClick(`#serverless已经适配的应用持续更新-nav`)" id=serverless已经适配的应用持续更新-nav>Serverless已经适配的应用（持续更新）</a></li><ul class=collapse data-toggle=collapse><li><a href=#multimedia-processing onclick="onNavClick(`#multimedia-processing-nav`)" id=multimedia-processing-nav>Multimedia processing</a></li><li><a href=#database onclick="onNavClick(`#database-nav`)" id=database-nav>Database</a></li><li><a href=#iot-sensor-input-messages onclick="onNavClick(`#iot-sensor-input-messages-nav`)" id=iot-sensor-input-messages-nav>IoT sensor input messages</a></li><li><a href=#stream-processing-at-scale onclick="onNavClick(`#stream-processing-at-scale-nav`)" id=stream-processing-at-scale-nav>Stream processing at scale</a></li><li><a href=#batch-jobs-or-scheduled-tasksworkflow%e9%9c%80%e8%a6%81%e7%bb%99%e5%ae%9a%e7%8a%b6%e6%80%81%e5%9b%be onclick="onNavClick(`#batch-jobs-or-scheduled-tasksworkflow需要给定状态图-nav`)" id=batch-jobs-or-scheduled-tasksworkflow需要给定状态图-nav>Batch jobs or scheduled tasks（workflow，需要给定状态图）</a></li><li><a href=#http-rest-apis-and-web-applications%e5%a4%a9%e7%84%b6%e9%80%82%e5%90%88 onclick="onNavClick(`#http-rest-apis-and-web-applications天然适合-nav`)" id=http-rest-apis-and-web-applications天然适合-nav>HTTP REST APIs and web applications（天然适合）</a></li></ul><li><a href=#serverless%e5%8f%af%e4%bb%a5%e4%bc%98%e5%8c%96%e7%9a%84%e5%ba%94%e7%94%a8%e6%8c%81%e7%bb%ad%e6%9b%b4%e6%96%b0 onclick="onNavClick(`#serverless可以优化的应用持续更新-nav`)" id=serverless可以优化的应用持续更新-nav>Serverless可以优化的应用（持续更新）</a></li><ul class=collapse data-toggle=collapse><li><a href=#video-encodingcompute-heavy-task onclick="onNavClick(`#video-encodingcompute-heavy-task-nav`)" id=video-encodingcompute-heavy-task-nav>video encoding(compute-heavy task)</a></li><li><a href=#mapreduce onclick="onNavClick(`#mapreduce-nav`)" id=mapreduce-nav>MapReduce</a></li><li><a href=#%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 onclick="onNavClick(`#线性代数-nav`)" id=线性代数-nav>线性代数</a></li><li><a href=#machine-learning onclick="onNavClick(`#machine-learning-nav`)" id=machine-learning-nav>Machine learning</a></li><li><a href=#database%e4%b8%8d%e5%a4%aa%e5%a5%bd%e8%a7%a3%e5%86%b3 onclick="onNavClick(`#database不太好解决-nav`)" id=database不太好解决-nav>Database（不太好解决）</a></li></ul><li><a href=#references%e6%94%b6%e9%9b%86 onclick="onNavClick(`#references收集-nav`)" id=references收集-nav>References收集</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a class=pagination-action v-on:click=toggleDarkMode><i class="material-icons pagination-action-icon" v-if=isDarkMode>brightness_4</i>
<i class="material-icons pagination-action-icon" v-else=isDarkMode>brightness_7</i></a></div></div><div class=single-column-drawer-container ref=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item active" href=/posts>归档</a>
<a class="a-block drawer-menu-item false" href=/categories>分类</a>
<a class="a-block drawer-menu-item false" href=/tags>标签</a><div class=toc><div class=toc-content><center>- CATALOG -</center><ul><li><a href=#serverless%e5%88%86%e6%9e%90 onclick="onNavClick(`#serverless分析-nav`)" id=serverless分析-nav>Serverless分析</a></li><ul class=collapse data-toggle=collapse><ul class=collapse data-toggle=collapse><li><a href=#%e7%89%b9%e7%82%b9 onclick="onNavClick(`#特点-nav`)" id=特点-nav>特点</a></li></ul><li><a href=#%e7%8e%b0%e4%bb%8aserverless%e7%9a%84%e6%9c%89%e9%99%90%e6%80%a7 onclick="onNavClick(`#现今serverless的有限性-nav`)" id=现今serverless的有限性-nav>现今Serverless的有限性</a></li><ul class=collapse data-toggle=collapse><li><a href=#%e5%ad%98%e5%82%a8%e5%af%b9%e4%ba%8e%e7%bb%86%e7%b2%92%e5%ba%a6%e6%93%8d%e4%bd%9c%e7%9a%84%e5%b1%80%e9%99%90%e6%80%a7 onclick="onNavClick(`#存储对于细粒度操作的局限性-nav`)" id=存储对于细粒度操作的局限性-nav>存储对于细粒度操作的局限性</a></li><li><a href=#%e7%bc%ba%e5%b0%91%e7%bb%86%e7%b2%92%e5%ba%a6%e7%9a%84%e6%b6%88%e6%81%af%e6%b2%9f%e9%80%9a onclick="onNavClick(`#缺少细粒度的消息沟通-nav`)" id=缺少细粒度的消息沟通-nav>缺少细粒度的消息沟通</a></li><li><a href=#%e6%a0%87%e5%87%86%e6%b2%9f%e9%80%9a%e6%a8%a1%e5%bc%8f%e5%af%b9%e4%ba%8e%e7%bb%86%e7%b2%92%e5%ba%a6%e7%9a%84%e6%80%a7%e8%83%bd%e5%a4%aa%e5%b7%ae onclick="onNavClick(`#标准沟通模式对于细粒度的性能太差-nav`)" id=标准沟通模式对于细粒度的性能太差-nav>标准沟通模式对于细粒度的性能太差</a></li><li><a href=#%e5%86%b7%e5%90%af%e5%8a%a8%e7%9a%84%e5%b1%80%e9%99%90%e6%80%a7 onclick="onNavClick(`#冷启动的局限性-nav`)" id=冷启动的局限性-nav>冷启动的局限性</a></li><ul class=collapse data-toggle=collapse><li><a href=#%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e5%86%b7%e5%90%af%e5%8a%a8%e4%bc%9a%e5%8f%91%e7%94%9f onclick="onNavClick(`#什么时候冷启动会发生-nav`)" id=什么时候冷启动会发生-nav>什么时候冷启动会发生？</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%97%b6%e5%80%99%e9%9c%80%e8%a6%81%e8%80%83%e8%99%91%e5%86%b7%e5%90%af%e5%8a%a8%e7%9a%84%e5%bd%b1%e5%93%8d onclick="onNavClick(`#什么时候需要考虑冷启动的影响-nav`)" id=什么时候需要考虑冷启动的影响-nav>什么时候需要考虑冷启动的影响？</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e5%86%b7%e5%90%af%e5%8a%a8%e6%96%b9%e6%a1%88 onclick="onNavClick(`#解决冷启动方案-nav`)" id=解决冷启动方案-nav>解决冷启动方案</a></li><li><a href=#%e9%99%8d%e4%bd%8e%e5%86%b7%e5%90%af%e5%8a%a8%e6%97%b6%e9%97%b4%e7%9a%84%e5%a5%bd%e5%a4%84 onclick="onNavClick(`#降低冷启动时间的好处-nav`)" id=降低冷启动时间的好处-nav>降低冷启动时间的好处</a></li></ul></ul><li><a href=#serverless%e5%8f%af%e4%bb%a5%e6%8e%a2%e7%b4%a2%e7%9a%84%e7%82%b9 onclick="onNavClick(`#serverless可以探索的点-nav`)" id=serverless可以探索的点-nav>Serverless可以探索的点</a></li><ul class=collapse data-toggle=collapse><li><a href=#abstraction onclick="onNavClick(`#abstraction-nav`)" id=abstraction-nav>Abstraction</a></li><li><a href=#system onclick="onNavClick(`#system-nav`)" id=system-nav>System</a></li><li><a href=#network onclick="onNavClick(`#network-nav`)" id=network-nav>Network</a></li><li><a href=#security onclick="onNavClick(`#security-nav`)" id=security-nav>Security</a></li><li><a href=#architecture onclick="onNavClick(`#architecture-nav`)" id=architecture-nav>Architecture</a></li></ul><li><a href=#serverless%e5%b7%b2%e7%bb%8f%e9%80%82%e9%85%8d%e7%9a%84%e5%ba%94%e7%94%a8%e6%8c%81%e7%bb%ad%e6%9b%b4%e6%96%b0 onclick="onNavClick(`#serverless已经适配的应用持续更新-nav`)" id=serverless已经适配的应用持续更新-nav>Serverless已经适配的应用（持续更新）</a></li><ul class=collapse data-toggle=collapse><li><a href=#multimedia-processing onclick="onNavClick(`#multimedia-processing-nav`)" id=multimedia-processing-nav>Multimedia processing</a></li><li><a href=#database onclick="onNavClick(`#database-nav`)" id=database-nav>Database</a></li><li><a href=#iot-sensor-input-messages onclick="onNavClick(`#iot-sensor-input-messages-nav`)" id=iot-sensor-input-messages-nav>IoT sensor input messages</a></li><li><a href=#stream-processing-at-scale onclick="onNavClick(`#stream-processing-at-scale-nav`)" id=stream-processing-at-scale-nav>Stream processing at scale</a></li><li><a href=#batch-jobs-or-scheduled-tasksworkflow%e9%9c%80%e8%a6%81%e7%bb%99%e5%ae%9a%e7%8a%b6%e6%80%81%e5%9b%be onclick="onNavClick(`#batch-jobs-or-scheduled-tasksworkflow需要给定状态图-nav`)" id=batch-jobs-or-scheduled-tasksworkflow需要给定状态图-nav>Batch jobs or scheduled tasks（workflow，需要给定状态图）</a></li><li><a href=#http-rest-apis-and-web-applications%e5%a4%a9%e7%84%b6%e9%80%82%e5%90%88 onclick="onNavClick(`#http-rest-apis-and-web-applications天然适合-nav`)" id=http-rest-apis-and-web-applications天然适合-nav>HTTP REST APIs and web applications（天然适合）</a></li></ul><li><a href=#serverless%e5%8f%af%e4%bb%a5%e4%bc%98%e5%8c%96%e7%9a%84%e5%ba%94%e7%94%a8%e6%8c%81%e7%bb%ad%e6%9b%b4%e6%96%b0 onclick="onNavClick(`#serverless可以优化的应用持续更新-nav`)" id=serverless可以优化的应用持续更新-nav>Serverless可以优化的应用（持续更新）</a></li><ul class=collapse data-toggle=collapse><li><a href=#video-encodingcompute-heavy-task onclick="onNavClick(`#video-encodingcompute-heavy-task-nav`)" id=video-encodingcompute-heavy-task-nav>video encoding(compute-heavy task)</a></li><li><a href=#mapreduce onclick="onNavClick(`#mapreduce-nav`)" id=mapreduce-nav>MapReduce</a></li><li><a href=#%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 onclick="onNavClick(`#线性代数-nav`)" id=线性代数-nav>线性代数</a></li><li><a href=#machine-learning onclick="onNavClick(`#machine-learning-nav`)" id=machine-learning-nav>Machine learning</a></li><li><a href=#database%e4%b8%8d%e5%a4%aa%e5%a5%bd%e8%a7%a3%e5%86%b3 onclick="onNavClick(`#database不太好解决-nav`)" id=database不太好解决-nav>Database（不太好解决）</a></li></ul><li><a href=#references%e6%94%b6%e9%9b%86 onclick="onNavClick(`#references收集-nav`)" id=references收集-nav>References收集</a></li></ul></div></div></div></div></div><transition name=fade><div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav ref=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div ref=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a ref=navTitle class=navbar-brand href=https://jessestutler.github.io/>Jesse's Blog</a>
<button type=button class=nav-darkmode-toggle v-on:click=toggleDarkMode>
<i class=material-icons v-if=isDarkMode>brightness_4</i>
<i class=material-icons v-else=isDarkMode>brightness_7</i></button></div></nav><div class=single-column-header-container ref=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://jessestutler.github.io/><div class=single-column-header-title>Jesse's Blog</div><div class=single-column-header-subtitle>Stay Hungry,Stay Foolish.</div></a></div><div id=content><div ref=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper style=background-image:url(https://jessestutler.github.io/images/serverless.jpg)><div class=post-title>Serverless分析<div class=post-subtitle>serverless现状分析（持续更新）</div><div class=post-meta><time itemprop=datePublished>2021-05-18 14:13</time>
<i class=material-icons>folder</i>
<a href=/categories/serverless>serverless</a>
&nbsp;
<i class=material-icons>label</i>
<a href=/tags/serverless>serverless</a>
&nbsp;</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><h1 id=serverless分析>Serverless分析</h1><p>本文根据Berkeley rise lab的综述Cloud Programming Simplifified:</p><p>A Berkeley View on Serverless Computing并结合其他相关材料进行总结，探究serverless的研究点，本文会持续进行更新。</p><p><em>简单的说，Serverless就是FaaS+BaaS</em></p><h3 id=特点>特点</h3><ul><li><p>按使用量付费（无请求时无资源无分配无花费，有请求时按使用量，按时间计算付费），性能提高（高并发量），autoscale，强隔离性（多租户），可供有突发流量情况而又无服务器扩展需求的公司使用；</p></li><li><p><strong>低请求量服务改造</strong>：原先需要一直监听请求的应用，当无请求来时需要一直占用资源，而改造成serverless可以用function代替原先的应用，这样无请求来临时可以down to zero，有请求来时再invoke一个或多个function实例（而且这些function是可以并行的）并进行处理；（不仅是针对可以减少资源使用量，而且可以应对流量尖峰）</p></li><li><p>由外部服务触发比如S3（有object更新，比如新增图片），消息队列（事件驱动，收到事件），或者以API gateway的形式（可以是以Backend或以function的形式）等待HTTP request到来触发</p></li><li><p><strong>一定是</strong>stateless，无法保证写到memory或者local disk的数据（VM上）下次被invoked还能读到，需要借助外部存储服务来保存状态或数据</p></li><li><p>适合short-lived task</p></li></ul><p>从serverful过渡到serverless就像从汇编语言过渡到高级语言一样，汇编语言计算一个c=a+b需要指定寄存器，存放，计算结果然后并存回，而serverful就像汇编语言一样需要先知道哪些资源是可用的，然后给资源加载code和环境，执行计算，再得到结果，这些原先需要平台使用者去知晓，但是serverless不需要programmer去知晓和管理资源，只需要<strong>编写code，编写function，编写业务就够了</strong></p><h2 id=现今serverless的有限性>现今Serverless的有限性</h2><h3 id=存储对于细粒度操作的局限性>存储对于细粒度操作的局限性</h3><p>因为function之间是相互隔离的，<strong>所以需要借助外部存储服务(BaaS)来提供状态的支持</strong>，这是serverless的特性所致。但是对于划分到function这么细粒度的操作来说，现在的外部存储服务要不是太贵（access或者storage）要不就是延迟太高，e.g:对象存储比如AWS S3等，access花费和延迟过高；key-value数据库存储费用高，扩容慢；内存存储如redis等没有容错性，不能自动扩缩。当然这要看应用的要求，但还是与serverless理想的存储方案相差不少。</p><h3 id=缺少细粒度的消息沟通>缺少细粒度的消息沟通</h3><p>背景：两个task合作，taskA需要taskB的output作为input，但是不知道何时output会过来，所以需要引入消息中间件，但是现有的消息中间件对于细粒度(task/function)操作的延迟和花费太高</p><p>可能的解决方案：自己设计消息通知机制比如长期运行一个汇集消息的server，能够以命名的方式直接定位到function实例从而获取到ouput等</p><h3 id=标准沟通模式对于细粒度的性能太差>标准沟通模式对于细粒度的性能太差</h3><p>背景：broadcast，shuffle，aggregation都是分布式系统中重要的原语，但是如果划分粒度过细，比如拿聚合来说，VM实例中的function如果本地不做聚合而每次聚合都需要到远端聚合，那么这个消息数量会成倍增加，shuffle则更多</p><h3 id=冷启动的局限性>冷启动的局限性</h3><p>1）启动function需要一定时间（分配和加载资源：分配VM，初始化container，将function的静态文件拷贝到container）</p><p>2）需要一些时间去下载函数执行环境（OS，库，语言的runtime比如JVM等）</p><ul><li><p>函数的package依赖需要经过远端的download，local install，import过程，这个时间比较长，是否可以在本地machine上预先下载好所有语言涉及的包？（通过压缩的方式存储）这样直接去本地加载package，省去去远端下载package的时间。<strong>所有container通过overlayfs或者bind mount共享已经安装好的package</strong></p></li><li><p>SOCK：利用Zygote机制预import一些需要的package（这样的Zygote很多，需要预import什么package就fork出新的Zygote），这样从Zygote进程fork出的新子进程不需要进行同样的初始化操作，直接从内存读取即可（减少开辟新内存的消耗）</p><blockquote><p>tips：fork出的子进程与父进程共享堆栈，fd，代码段，由于copy-on-write，只有子进程写时才会完全拷贝</p></blockquote><p><strong>含Zygote进程的container&ndash;>含从Zygote fork出的子进程的container</strong></p></li></ul><p>3）有些应用对于代码需要做一些定制的初始化操作，需要花费一定时间（比如加载和初始化数据结构，库等）</p><p>4）如果需要频繁冷启动，namespace的频繁creation和cleanup需要性能损耗</p><h4 id=什么时候冷启动会发生>什么时候冷启动会发生？</h4><ol><li>当function的code或者配置改变的时候，或者function第一次部署的时候</li><li>idle instance被shut down</li><li>instance到了最大age被shut down（即使仍然在运行）</li><li>之前的instance都在忙于处理请求，需要横向扩展的时候</li></ol><h4 id=什么时候需要考虑冷启动的影响>什么时候需要考虑冷启动的影响？</h4><p>也许像要访问存储服务的function本来就需要等待存取的latency，冷启动时间相对这段latency可有可无；也许实时数据流服务会频繁地invoke function，function会一直处理event很多次（可能200000次在到达最大age之前），那冷启动时间也可有可无。</p><p>但是对于请求量较少的function，可能一小时invoke一次，就有可能中间被shut down，需要每次都冷启动，那就需要考虑冷启动的开销，如果冷启动需要加载的依赖和库过大，就有可能需要很多的冷启动时间；对于需要快速回应的应用也需要考虑冷启动的影响</p><h4 id=解决冷启动方案>解决冷启动方案</h4><ol><li>AWS使用VM就绪池，在function启动之前就准备接收function的调度，这样基本上只受scheduling latency的影响</li><li>尽可能的减少依赖，尽可能地用加载较快的语言（像Java中的JVM加载较慢）</li></ol><h4 id=降低冷启动时间的好处>降低冷启动时间的好处</h4><ol><li>可以让idle instance更少一些，可用资源更多一些（这样就不用因为担心冷启动时间过长而一直等待后续的请求了）</li></ol><h2 id=serverless可以探索的点>Serverless可以探索的点</h2><h3 id=abstraction>Abstraction</h3><ul><li><p>Resouce requirements</p><p>不要让serverless平台的使用者来指定要使用多少资源，这样违背于serverless的理念（不应该管理资源），而且会降低资源的利用率。<strong>更好的做法</strong>是让cloud provider来推断出需要使用多少资源，比如<strong>静态代码分析，归档之前跑完的数据，动态编译等等</strong>，总而言之就是要自动的推断出需要多少资源。</p></li><li><p>Data dependencies</p><p>现在的serverless平台无法知晓function之间存在什么数据依赖，甚至需要交换的数据的规模。<strong>更好的做法</strong>是暴露一个API让应用指明function的computation graph，以便更好地放置function的位置；而且可以引入coordinator来解决function之间顺序依赖的关系，和调控function的状态（function为有限状态机，收到消息发生状态改变）</p></li></ul><h3 id=system>System</h3><ul><li><p>Storage</p><ol><li><strong>Ephemeral storage</strong>（暂时存储）</li></ol><p>既然serverless computing需要的是暂时的状态存储，当计算结束时这些状态就可以丢弃，那么可以用暂时存储的方案，比如用内存存储（以分布式内存存储的方式），利用RDMA来减少延迟，利用共享内存的方式来减少serverful computing中内存被VM实例独占，无用内存碎片过多的情况</p><ol start=2><li>Durable storage（长期存储）</li></ol><p>大部分都是暂时存储的情况（我觉得serverless也是适用于暂时存储），但是如果针对于设计serverless数据库的话需要长期存储，可能需要多个存储服务的结合，以及像SSD这样提高硬盘的IOPS</p></li><li><p>Coordination/signaling service</p><p><strong>解决缺少细粒度的消息沟通和数据一致性问题</strong>（因为多个function可能会放到一起，所以分布式系统中的一致性算法和leader election不适用）</p></li><li><p>Minimize startup time</p><p><strong>解决冷启动的局限性</strong></p><ol><li><p>解决1）：提供更新的轻量级的隔离机制（e.g:Firecracker）</p></li><li><p>解决2）：利用unikernels，预配置硬件，静态分配数据结构，只包含应用所需的驱动和函数库等；或者动态地加载函数库（有点类似ddl）</p></li><li><p>解决3）：提前做初始化操作；当做完初始化操作call readiness API去通知function工作；利用warm pool存放已经加载好的拥有流行的系统和库的实例等</p></li><li><p><strong>WebAssembly</strong>，有一项调查显示其实50%的function运行时间不超过100ms，但是启动container和加载runtime时间却远远超过100ms以上。</p><blockquote><p>VM或者container初始化需要设置system library以供系统调用使用，这会引入开销；且VM或container下的现有付费模型是根据内存使用量和使用时间来计算的，像细粒度的cpu周期使用量等没有涉及到</p></blockquote></li></ol></li></ul><h3 id=network>Network</h3><p>解决标准沟通模式对于细粒度的性能太差问题，解决方案可同Abstraciton——data dependencies，让应用提供一个computation graph，以便serverless平台能够将一些function放置到同一VM实例中，<strong>减少通过network发送的消息，尽量在本地先处理完</strong></p><p>解决方案：</p><p>1）eBPF Tail & Function Calls？</p><h3 id=security>Security</h3><p>暂不考虑</p><h3 id=architecture>Architecture</h3><ul><li><p>硬件的异构性和性能提升陷入瓶颈</p><p>背景：同样的架构但是不同时代的产品，虽然价格一样但是速度可能不同；硬件性能提升陷入瓶颈</p><p>解决方法：</p><p>1）使用语言特定的处理器提升处理速度</p><p>2）使用DSA（Domain Specific Architectures），比如GPU加速图像处理，TPU加速factor处理等</p></li></ul><h2 id=serverless已经适配的应用持续更新>Serverless已经适配的应用（持续更新）</h2><h3 id=multimedia-processing>Multimedia processing</h3><ul><li>比如有一个图片上传（比如用户上传头像）到AWS S3这样的object storage，触发function将图片处理成缩略图，然后重新存回到AWS S3或者网站自己的存储服务当中</li><li>或者有一个文件上传后触发function将文件进行压缩然后重新存回</li></ul><h3 id=database>Database</h3><ul><li>当数据库更新的时候invoke一些function进行一些动作，比如添加或删除的时候</li><li>网站上有天气系统，当点击查看时触发function取得数据库的天气数据</li><li>支撑购物系统快速获取商品信息</li></ul><h3 id=iot-sensor-input-messages>IoT sensor input messages</h3><ul><li>处理或过滤来自IoT device的MQTT消息，实时性要求高</li></ul><h3 id=stream-processing-at-scale>Stream processing at scale</h3><ul><li>连接消息源处理事件流，实时性要求高，serverless弹性扩缩能力和高并发能力天然适合</li></ul><h3 id=batch-jobs-or-scheduled-tasksworkflow需要给定状态图>Batch jobs or scheduled tasks（workflow，需要给定状态图）</h3><ul><li>一天内不会需要很多时间处理的batch job，可以在一天内的其他时间不需要一直running</li></ul><h3 id=http-rest-apis-and-web-applications天然适合>HTTP REST APIs and web applications（天然适合）</h3><ul><li>简单的REST操作适合serverless</li></ul><h2 id=serverless可以优化的应用持续更新>Serverless可以优化的应用（持续更新）</h2><p><strong>优点</strong></p><p>1）function实例启动快</p><p>2）花费少（按使用量计费）</p><p>3）可以invoke多个实例并行处理请求（<strong>主要原因</strong>）</p><p><strong>引入的问题</strong>（如何将原来的应用迁移成细粒度的function）</p><p>1）如果仅仅是简单地将应用划分成不同的代码段，一个代码段一个function，那这些不同的function不能很好地用到warm start，每次都是cold start</p><p>2）可能会受到平台实例并发数量的限制</p><p>3）如果function instance是有顺序协作关系的（以链的形式），可能会发生死锁</p><p>4）并发性能是提高了，但是如何保证拥有和改造前应用相近的质量？（是否要斟酌牺牲一点？）</p><h3 id=video-encodingcompute-heavy-task>video encoding(compute-heavy task)</h3><p>背景：现有的编码方案需要花费数十分钟甚至数十小时去上传视频</p><p>已有的解决方案：ExCamera，以函数语义并行执行编码的慢的部分，串行快的部分</p><h3 id=mapreduce>MapReduce</h3><p>背景：Map，Shuffle，Reduce皆可以移植到serverless computing，在mapreduce期间资源需求变化很大</p><p>已有的解决方案：只解决了Map-Only job，整套的MapReduce待解决</p><h3 id=线性代数>线性代数</h3><p>背景：并行数量在计算期间变化很大，移植到serverless computing可以提高执行速度并且提高资源利用率</p><p>已有的解决方案：Numpywren</p><h3 id=machine-learning>Machine learning</h3><p>背景：预处理，模型训练等不同阶段的资源需求变化大，与线性代数类似</p><p>已有的解决方案：Cirrus</p><h3 id=database不太好解决>Database（不太好解决）</h3><p>背景：使用cloud function来进行数据存储，但是需要存储服务的支持（Backend）；但是数据库连接又需要特定协议，从函数层面上不到网络层这一层；</p><h2 id=references收集>References收集</h2><ul><li><p><a href=https://blog.symphonia.io/posts/2017-11-14_learning-lambda-part-8>https://blog.symphonia.io/posts/2017-11-14_learning-lambda-part-8</a> Learning Lambda — Part 8 cold starts</p></li><li><p><a href=https://blog.symphonia.io/posts/2020-06-30_analyzing_cold_start_latency_of_aws_lambda>https://blog.symphonia.io/posts/2020-06-30_analyzing_cold_start_latency_of_aws_lambda</a> Analyzing Cold Start latency of AWS Lambda</p></li><li><p><a href=https://archive.fosdem.org/2020/schedule/event/containers_bpf/>https://archive.fosdem.org/2020/schedule/event/containers_bpf/</a> BPF as a revolutionary technology for the container landscape</p></li><li><p><a href=https://github.com/cncf/wg-serverless/tree/master/whitepapers/serverless-overview>https://github.com/cncf/wg-serverless/tree/master/whitepapers/serverless-overview</a> CNCF Serverless Whitepaper v1.0</p></li><li><p>chrome-extension://ikhdkkncnoglghljlkmcimlnlhkeamad/pdf-viewer/web/viewer.html?file=https%3A%2F%2Farxiv.org%2Fpdf%2F2010.07115.pdf</p><p>SSVM——WebAssembly Virtual machine</p></li></ul><hr width=100% id=EOF><p style=color:#777>Last modified on 2021-05-18</p></div></div><nav class=post-pagination><a class=newer-posts>Next<br>No newer posts.</a>
<a class=older-posts href=https://jessestutler.github.io/posts/raft/>Previous<br>Raft</a></nav><div class=post-comment-wrapper><div id=gitalk-container></div></div></div></div></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> by <a href=https://amazingrise.net>Rise</a><br>Ported from <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br>&copy;
本站遵循 CC-BY-NC 4.0 协议</div></div><script>let app;app=new Vue({el:'#app',data:{scrollY:0,navOpacity:0,isDrawerOpen:!1,mounted:!1,isDarkMode:!1},methods:{sgn(a,b){let c=1/(1-2*a);return b<=a?0:b>=1-a?1:c*(b-a)},handleScroll(){this.scrollY=window.scrollY,this.navOpacity=this.sgn(0,Math.min(1,Math.max(0,window.scrollY/(this.pageHeadHeight()-this.navBarHeight()*.8))));const{navBar:c,navBackground:a,navTitle:b,extraContainer:d,streamContainer:e}=this.$refs;this.navOpacity>=1?(a.style.opacity=1,b.style.opacity=1):(a.style.opacity=0,b.style.opacity=0)},handleResize(){const{navBar:c,navBackground:d,navTitle:e,extraContainer:a,streamContainer:b}=this.$refs;a.style.left=b.offsetWidth-a.offsetWidth+'px'},navBarHeight(){return this.$refs.navBar.offsetHeight},pageHeadHeight(){return this.$refs.pageHead.offsetHeight},toggleDrawer(){this.isDrawerOpen=!this.isDrawerOpen,document.getElementsByTagName('html')[0].style.overflow=this.isDrawerOpen?'hidden':'unset'},closeDrawer(){this.isDrawerOpen=!1,document.getElementsByTagName('html')[0].style.overflow=this.isDrawerOpen?'hidden':'unset'},toggleDarkMode(){this.isDarkMode=!this.isDarkMode,this.isDarkMode==!0?(document.cookie="night=1;path=/",document.body.classList.add("night")):(document.cookie="night=0;path=/",document.body.classList.remove("night"))}},created(){window.addEventListener('scroll',this.handleScroll),window.addEventListener('resize',this.handleResize),window._nonDesktop=function(){let a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a};var a=document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/,"$1");a==""?window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches:a=="1"&&this.toggleDarkMode()},mounted(){this.handleScroll(),this.handleResize(),this.mounted=!0},destroyed(){window.removeEventListener('scroll',this.handleScroll),window.removeEventListener('resize',this.handleResize)}})</script><script src=https://jessestutler.github.io//js/journal.js></script></body></html>